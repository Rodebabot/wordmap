import os
import pandas as pd

# Step 1: Define base directory
base_path = r'YOUR\BASE\DIRECTORY\PATH'  # Replace with your actual directory

# Step 2: Get all folders that start with "number + space" like "01 Jan", "02 Feb"
month_folders = [f for f in os.listdir(base_path) if os.path.isdir(os.path.join(base_path, f)) and f[:2].isdigit()]

if not month_folders:
    raise Exception(f"No month folders with numeric prefix found in {base_path}")

# Sort by the numeric prefix to find the latest month
latest_month = max(month_folders, key=lambda x: int(x[:2]))
month_path = os.path.join(base_path, latest_month)
print("✅ Latest Month Folder:", latest_month)

# Step 3: Inside latest month, find latest date folder (assuming named like '01', '15', '30')
date_folders = [f for f in os.listdir(month_path) if f.isdigit() and os.path.isdir(os.path.join(month_path, f))]

if not date_folders:
    raise Exception(f"No numeric date folders found in {month_path}")

latest_date = max(date_folders, key=lambda x: int(x))
final_path = os.path.join(month_path, latest_date)
print("✅ Latest Date Folder:", latest_date)

# Step 4: Get CSV files
csv_files = sorted([f for f in os.listdir(final_path) if f.lower().endswith('.csv')])

if len(csv_files) < 3:
    raise Exception(f"Less than 3 CSV files found in {final_path}. Found: {len(csv_files)}")

# Step 5: Read CSVs
df1 = pd.read_csv(os.path.join(final_path, csv_files[0]))
df2 = pd.read_csv(os.path.join(final_path, csv_files[1]))
df3 = pd.read_csv(os.path.join(final_path, csv_files[2]))

print("✅ Loaded CSVs:", csv_files[:3])
